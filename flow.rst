Flow
====


The User Directory is used to publish encryption keys for applications. The diagram below shows its interaction 
with other parts of a cloud storage infrastructure.


.. image:: https://raw.githubusercontent.com/tarekziade/fxakeys/master/fxakeys.jpg


The flow is the following:

- A user connects to their FxA account with Application through an OAuth2 flow. 
- Application gets through this flow an authorization token it can trade for a bearer token 
- The token can be used to connect to the Storage service and to the Key service
- The FxA auth can also be used to generate a key pair for the application
- The public key generated by the application is published into the Key service
- The application can use the Key service to discover other users keys and encrypt data



